<%- include header.html %>
<div id="coreContent" class="core_content">

<div class="admin_hd">添加项目</div>
<form method="post" class="cate_add_form form-horizontal" enctype="multipart/form-data">
    <div class="form-group">
        <label class="form_key ">项目名称</label>
        <div class="form_val">
            <input type="text" name="project_name" value="<%=data.project_name || '' %>" class="form-control" >
        </div>
    </div>
    <div class="form-group">
        <label class="form_key ">项目标识</label>
        <div class="form_val">
            <input type="text" name="vid" id="vidText" value="<%=data.vid || '' %>" class="form-control" > 
            <span id="vidCheckRet">keyong</span>
        </div>
    </div>
    <div class="form-group">
        <label class="form_key ">管理员</label>
        <div class="form_val">
            <input type="hidden" name="manager" id="managerList" value="<%=data.manager || username %>">

            <span class="user_item"><%=username %></span>
            <div class="user_item_list">
                <% data.managerArr.forEach(function (item, index) { %>
                    <span class="user_item"><%=item %></span>
                <% }) %>
                <input type="text" value="" class="userItem">
                <input type="text" value="" class="userItem">
            </div>

            <span class="btn btn-primary" id="btnTest">Add </span>
        </div>
        <script>
            $('#vidText').on('blur', function(){
                var vid = $(this).val().trim()
                $.ajax({
                    url: '/vid/check/' + vid
                }).done(function(xhr, status){
                    if(status=='success'){
                        $('#vidCheckRet').html(xhr.error ? '重复' : '可用')
                    }
                })
            })
            $('.userItem').on('blur', function(){
                var user = $(this).val().trim()
                var oldList = $('#managerList').val().split(',');
                if($.inArray(user, oldList) == -1) {
                    oldList.push(user)
                }
                $('#managerList').val(oldList.join(','))
            })
        </script>
    </div>
    <div class="form-group">
        <label class="form_key ">项目成员</label>
        <div class="form_val">
            <input type="hidden" name="member" value="<%=data.member || ''%>">
            <span class="user_item"><%=username %></span>
            <input type="text" value="" class="user_item_ipt">
            <!-- todo: show member -->
            <span class="btn btn-primary">Add</span>
        </div>
    </div>
    <div class="form-group">
        <label class="form_key ">访问权限</label>
        <div class="form_val">
            <input type="checkbox" name="private" <%=(data.private && 'checked' || '')%> value="1"> 仅项目成员可见
        </div>
    </div>
    <div class="form-group">
        <label class="form_key ">Logo图片</label>
        <div class="form_val">
            <div class="input_file_wrap" style="background-image:url(<%=data.logo || 'about:blank'%>)">
                <input type="file" name="logo" >
            </div>
        </div>
    </div>
    <div class="form-group">
        <label class="form_key ">封面图片</label>
        <div class="form_val">
            <div class="input_file_wrap" style="background-image:url(<%=data.cover || 'about:blank'%>)">
                <input type="file" name="cover" >
            </div>
        </div>
    </div>
    <div class="form-group">
        <label class="form_key ">项目颜色</label>
        <div class="form_val">
            <input type="hidden" name="theme" value="<%=data.theme || 'blue'%>" >
            <!-- todo: show other theme -->
            <span>red </span>,
            <span>blue </span>
        </div>
    </div>
    <div class="form-group">
        <label class="form_key ">&nbsp;</label>
        <div class="form_val">
            <button type="submit" class="btn btn-success">添加</button>
        </div>
    </div>
</form>

</div>
<%- include footer.html %>
